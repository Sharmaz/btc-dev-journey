"use strict";(globalThis.webpackChunkbtc_dev_journey=globalThis.webpackChunkbtc_dev_journey||[]).push([[8881],{7901(e,i,n){n.r(i),n.d(i,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"cross-cutting/security/index","title":"Security","description":"Security practices for Bitcoin development - key management, threat modeling, and secure coding","source":"@site/docs/cross-cutting/security/index.md","sourceDirName":"cross-cutting/security","slug":"/cross-cutting/security/","permalink":"/docs/cross-cutting/security/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Security","description":"Security practices for Bitcoin development - key management, threat modeling, and secure coding"},"sidebar":"guideSidebar","previous":{"title":"Protocols on Bitcoin","permalink":"/docs/tracks/application-developer/protocols-on-bitcoin/"},"next":{"title":"Privacy","permalink":"/docs/cross-cutting/privacy/"}}');var s=n(4848),t=n(8453);const l={sidebar_position:1,title:"Security",description:"Security practices for Bitcoin development - key management, threat modeling, and secure coding"},c="Security",d={},o=[{value:"Key Management",id:"key-management",level:2},{value:"Principles",id:"principles",level:3},{value:"Backup Strategies",id:"backup-strategies",level:3},{value:"Common Mistakes",id:"common-mistakes",level:3},{value:"Threat Modeling",id:"threat-modeling",level:2},{value:"STRIDE Model Applied to Bitcoin",id:"stride-model-applied-to-bitcoin",level:3},{value:"Application-Specific Threats",id:"application-specific-threats",level:3},{value:"Secure Coding Practices",id:"secure-coding-practices",level:2},{value:"Input Validation",id:"input-validation",level:3},{value:"Dependency Management",id:"dependency-management",level:3},{value:"Testing for Security",id:"testing-for-security",level:3},{value:"Operational Security",id:"operational-security",level:2},{value:"Node Security",id:"node-security",level:3},{value:"Production Deployment",id:"production-deployment",level:3},{value:"Recommended Reading",id:"recommended-reading",level:2}];function a(e){const i={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.header,{children:(0,s.jsx)(i.h1,{id:"security",children:"Security"})}),"\n",(0,s.jsx)(i.p,{children:"Security in Bitcoin development is non-negotiable. You're building software that handles real money \u2014 a single vulnerability can mean irreversible loss of funds. This section covers security principles that apply across all specialization tracks."}),"\n",(0,s.jsxs)(i.p,{children:["For cryptographic primitives specific to Bitcoin Core, see ",(0,s.jsx)(i.a,{href:"/docs/tracks/protocol-developer/security-cryptography",children:"Security & Cryptography"}),"."]}),"\n",(0,s.jsx)(i.h2,{id:"key-management",children:"Key Management"}),"\n",(0,s.jsx)(i.p,{children:"The most critical security challenge in any Bitcoin application."}),"\n",(0,s.jsx)(i.h3,{id:"principles",children:"Principles"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Never store private keys in plaintext"})," \u2014 Encrypt at rest using strong encryption (AES-256-GCM)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Minimize key exposure"})," \u2014 Keys should only be decrypted in memory, for the shortest time possible"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Use hardware security modules (HSMs)"})," or hardware wallets for signing when possible"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Implement key rotation"})," \u2014 Have a plan for rotating compromised keys"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Separate hot and cold keys"})," \u2014 Only keep the minimum necessary funds in hot wallets"]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"backup-strategies",children:"Backup Strategies"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"Strategy"}),(0,s.jsx)(i.th,{children:"Pros"}),(0,s.jsx)(i.th,{children:"Cons"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"Mnemonic seed (BIP-39)"})}),(0,s.jsx)(i.td,{children:"Human-readable, portable"}),(0,s.jsx)(i.td,{children:"Single point of failure if not split"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"Shamir's Secret Sharing"})}),(0,s.jsx)(i.td,{children:"Threshold recovery (e.g., 3-of-5)"}),(0,s.jsx)(i.td,{children:"More complex setup"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"Metal backup"})}),(0,s.jsx)(i.td,{children:"Fire/water resistant"}),(0,s.jsx)(i.td,{children:"Physical security required"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"Multi-location"})}),(0,s.jsx)(i.td,{children:"Resilient to local disaster"}),(0,s.jsx)(i.td,{children:"Coordination overhead"})]})]})]}),"\n",(0,s.jsx)(i.h3,{id:"common-mistakes",children:"Common Mistakes"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Logging private keys or mnemonics"}),"\n",(0,s.jsx)(i.li,{children:"Storing keys in environment variables or config files in version control"}),"\n",(0,s.jsx)(i.li,{children:"Using weak randomness for key generation"}),"\n",(0,s.jsx)(i.li,{children:"Not encrypting wallet files on disk"}),"\n",(0,s.jsx)(i.li,{children:"Reusing keys across different applications"}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"threat-modeling",children:"Threat Modeling"}),"\n",(0,s.jsx)(i.p,{children:"Before writing code, understand what you're defending against."}),"\n",(0,s.jsx)(i.h3,{id:"stride-model-applied-to-bitcoin",children:"STRIDE Model Applied to Bitcoin"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"Threat"}),(0,s.jsx)(i.th,{children:"Bitcoin Example"}),(0,s.jsx)(i.th,{children:"Mitigation"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"Spoofing"})}),(0,s.jsx)(i.td,{children:"Fake node serving false data"}),(0,s.jsx)(i.td,{children:"Verify against full node"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"Tampering"})}),(0,s.jsx)(i.td,{children:"Modified transaction before broadcast"}),(0,s.jsx)(i.td,{children:"Sign transactions client-side"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"Repudiation"})}),(0,s.jsx)(i.td,{children:"Denying a payment was made"}),(0,s.jsx)(i.td,{children:"Blockchain is the proof"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"Information Disclosure"})}),(0,s.jsx)(i.td,{children:"Address reuse reveals balance"}),(0,s.jsx)(i.td,{children:"New address per transaction"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"Denial of Service"})}),(0,s.jsx)(i.td,{children:"Node overwhelmed with requests"}),(0,s.jsx)(i.td,{children:"Rate limiting, connection limits"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"Elevation of Privilege"})}),(0,s.jsx)(i.td,{children:"RPC access without authentication"}),(0,s.jsx)(i.td,{children:"Strong RPC credentials, firewall"})]})]})]}),"\n",(0,s.jsx)(i.h3,{id:"application-specific-threats",children:"Application-Specific Threats"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Address substitution"})," \u2014 Malware replaces displayed addresses (verify on hardware device)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Fee sniping"})," \u2014 Attacker re-mines blocks to steal transactions (use ",(0,s.jsx)(i.code,{children:"nLockTime"}),")"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Dust attacks"})," \u2014 Small UTXOs sent to track spending patterns (coin control)"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Supply chain attacks"})," \u2014 Compromised dependencies (verify signatures, minimize deps)"]}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"secure-coding-practices",children:"Secure Coding Practices"}),"\n",(0,s.jsx)(i.h3,{id:"input-validation",children:"Input Validation"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"\u2713 Validate all addresses before sending (checksum, network)\n\u2713 Validate transaction amounts (positive, within range)\n\u2713 Validate fee rates (sane bounds, not absurdly high)\n\u2713 Sanitize all user input before RPC calls\n\u2717 Never construct RPC commands via string concatenation\n"})}),"\n",(0,s.jsx)(i.h3,{id:"dependency-management",children:"Dependency Management"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Pin dependency versions"}),"\n",(0,s.jsx)(i.li,{children:"Verify package integrity (checksums, signatures)"}),"\n",(0,s.jsx)(i.li,{children:"Audit dependencies for known vulnerabilities"}),"\n",(0,s.jsx)(i.li,{children:"Prefer well-audited Bitcoin-specific libraries over general-purpose crypto"}),"\n",(0,s.jsx)(i.li,{children:"Minimize total dependency count"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"testing-for-security",children:"Testing for Security"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Fuzz test"})," parsing and deserialization code"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Test with invalid inputs"})," \u2014 Malformed transactions, addresses, scripts"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Test fee edge cases"})," \u2014 Zero fee, maximum fee, dust amounts"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Test concurrent access"})," \u2014 Race conditions in wallet operations"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Review error handling"})," \u2014 Ensure failures don't leak sensitive data"]}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"operational-security",children:"Operational Security"}),"\n",(0,s.jsx)(i.h3,{id:"node-security",children:"Node Security"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Run your own full node (don't trust third-party nodes for validation)"}),"\n",(0,s.jsx)(i.li,{children:"Keep Bitcoin Core updated to latest stable release"}),"\n",(0,s.jsx)(i.li,{children:"Firewall RPC port (8332/18332/18443) \u2014 never expose to the internet"}),"\n",(0,s.jsx)(i.li,{children:"Use strong, unique RPC credentials"}),"\n",(0,s.jsx)(i.li,{children:"Enable Tor for network privacy"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"production-deployment",children:"Production Deployment"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Separate signing from broadcasting (air-gapped signing)"}),"\n",(0,s.jsx)(i.li,{children:"Implement rate limits on withdrawal APIs"}),"\n",(0,s.jsx)(i.li,{children:"Use multi-signature for organizational funds"}),"\n",(0,s.jsx)(i.li,{children:"Monitor for unusual transaction patterns"}),"\n",(0,s.jsx)(i.li,{children:"Have an incident response plan for key compromise"}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"recommended-reading",children:"Recommended Reading"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://blog.lopp.net/bitcoin-security-model/",children:"Bitcoin Security Model (Lopp)"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://cryptoconsortium.org/certification/ccss/",children:"Cryptocurrency Security Standard (CCSS)"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://bitcoin.design/guide/how-it-works/private-key-management/",children:"Bitcoin Design Guide: Security"})}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.a,{href:"https://owasp.org/",children:"OWASP for Bitcoin"})," \u2014 Apply web security principles to Bitcoin apps"]}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,t.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},8453(e,i,n){n.d(i,{R:()=>l,x:()=>c});var r=n(6540);const s={},t=r.createContext(s);function l(e){const i=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function c(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),r.createElement(t.Provider,{value:i},e.children)}}}]);