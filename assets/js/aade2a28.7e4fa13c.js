"use strict";(globalThis.webpackChunkbtc_dev_journey=globalThis.webpackChunkbtc_dev_journey||[]).push([[2881],{5392(e,i,r){r.r(i),r.d(i,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"tracks/protocol-developer/security-cryptography/index","title":"Security & Cryptography","description":"Threat models, cryptographic primitives, and security practices in Bitcoin development","source":"@site/docs/tracks/protocol-developer/06-security-cryptography/index.md","sourceDirName":"tracks/protocol-developer/06-security-cryptography","slug":"/tracks/protocol-developer/security-cryptography/","permalink":"/docs/tracks/protocol-developer/security-cryptography/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"title":"Security & Cryptography","description":"Threat models, cryptographic primitives, and security practices in Bitcoin development"},"sidebar":"guideSidebar","previous":{"title":"Specialization Areas","permalink":"/docs/tracks/protocol-developer/specialization-areas/"},"next":{"title":"Contributing to Bitcoin Core","permalink":"/docs/tracks/protocol-developer/contributing-bitcoin-core/"}}');var n=r(4848),s=r(8453);const c={sidebar_position:6,title:"Security & Cryptography",description:"Threat models, cryptographic primitives, and security practices in Bitcoin development"},o="Security & Cryptography",l={},d=[{value:"Threat Model",id:"threat-model",level:2},{value:"Common Attack Vectors",id:"common-attack-vectors",level:3},{value:"Cryptographic Primitives",id:"cryptographic-primitives",level:2},{value:"Hash Functions",id:"hash-functions",level:3},{value:"Elliptic Curve Cryptography",id:"elliptic-curve-cryptography",level:3},{value:"Signature Schemes",id:"signature-schemes",level:3},{value:"Tagged Hashes",id:"tagged-hashes",level:3},{value:"Security Practices in Bitcoin Core",id:"security-practices-in-bitcoin-core",level:2},{value:"Responsible Disclosure",id:"responsible-disclosure",level:3},{value:"Defensive Programming",id:"defensive-programming",level:3},{value:"Recommended Reading",id:"recommended-reading",level:2}];function a(e){const i={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.header,{children:(0,n.jsx)(i.h1,{id:"security--cryptography",children:"Security & Cryptography"})}),"\n",(0,n.jsx)(i.p,{children:"Security isn't a feature in Bitcoin \u2014 it's the foundation. Protocol developers must think adversarially at every level, from cryptographic primitives to network-level attacks."}),"\n",(0,n.jsx)(i.h2,{id:"threat-model",children:"Threat Model"}),"\n",(0,n.jsx)(i.p,{children:"Bitcoin's security model assumes:"}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Miners can be adversarial"})," \u2014 The system must remain secure even if a minority of miners are malicious"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Network can be unreliable"})," \u2014 Nodes may lose connectivity, receive delayed messages, or be partitioned"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Peers can lie"})," \u2014 Never trust data from a peer without independent verification"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Hardware can fail"})," \u2014 Software must handle crashes and corruption gracefully"]}),"\n"]}),"\n",(0,n.jsx)(i.h3,{id:"common-attack-vectors",children:"Common Attack Vectors"}),"\n",(0,n.jsxs)(i.table,{children:[(0,n.jsx)(i.thead,{children:(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.th,{children:"Attack"}),(0,n.jsx)(i.th,{children:"Description"}),(0,n.jsx)(i.th,{children:"Mitigation"})]})}),(0,n.jsxs)(i.tbody,{children:[(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.strong,{children:"51% attack"})}),(0,n.jsx)(i.td,{children:"Majority hashpower rewrites history"}),(0,n.jsx)(i.td,{children:"Economic cost, social consensus"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.strong,{children:"Eclipse attack"})}),(0,n.jsx)(i.td,{children:"Isolate a node from the real network"}),(0,n.jsx)(i.td,{children:"Multiple peer connections, diverse sources"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.strong,{children:"Sybil attack"})}),(0,n.jsx)(i.td,{children:"Create many fake peers"}),(0,n.jsx)(i.td,{children:"Connection limits, address management"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.strong,{children:"Transaction malleability"})}),(0,n.jsx)(i.td,{children:"Modify txid without invalidating"}),(0,n.jsx)(i.td,{children:"SegWit (witness separation)"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.strong,{children:"Time-warp attack"})}),(0,n.jsx)(i.td,{children:"Manipulate timestamps to lower difficulty"}),(0,n.jsx)(i.td,{children:"Median-time-past rules"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.strong,{children:"Selfish mining"})}),(0,n.jsx)(i.td,{children:"Withhold blocks to gain advantage"}),(0,n.jsx)(i.td,{children:"Protocol improvements, monitoring"})]})]})]}),"\n",(0,n.jsx)(i.h2,{id:"cryptographic-primitives",children:"Cryptographic Primitives"}),"\n",(0,n.jsx)(i.h3,{id:"hash-functions",children:"Hash Functions"}),"\n",(0,n.jsxs)(i.table,{children:[(0,n.jsx)(i.thead,{children:(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.th,{children:"Function"}),(0,n.jsx)(i.th,{children:"Use in Bitcoin"}),(0,n.jsx)(i.th,{children:"Output Size"})]})}),(0,n.jsxs)(i.tbody,{children:[(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:"SHA-256"}),(0,n.jsx)(i.td,{children:"Block hashing, txid, proof-of-work"}),(0,n.jsx)(i.td,{children:"256 bits"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:"RIPEMD-160"}),(0,n.jsx)(i.td,{children:"Address generation (HASH160 = SHA256 + RIPEMD160)"}),(0,n.jsx)(i.td,{children:"160 bits"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:"SHA-256d"}),(0,n.jsx)(i.td,{children:"Double SHA-256 for most internal hashing"}),(0,n.jsx)(i.td,{children:"256 bits"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:"SipHash"}),(0,n.jsx)(i.td,{children:"Mempool short txid, hash table protection"}),(0,n.jsx)(i.td,{children:"64 bits"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:"SHA-512"}),(0,n.jsx)(i.td,{children:"HMAC for BIP-32 key derivation"}),(0,n.jsx)(i.td,{children:"512 bits"})]})]})]}),"\n",(0,n.jsx)(i.h3,{id:"elliptic-curve-cryptography",children:"Elliptic Curve Cryptography"}),"\n",(0,n.jsxs)(i.p,{children:["Bitcoin uses the ",(0,n.jsx)(i.strong,{children:"secp256k1"})," curve:"]}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Field"}),": 256-bit prime field"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Key generation"}),": Private key (random 256-bit integer) \u2192 Public key (curve point multiplication)"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Core property"}),": Easy to compute ",(0,n.jsx)(i.code,{children:"pubkey = privkey * G"}),", computationally infeasible to reverse"]}),"\n"]}),"\n",(0,n.jsx)(i.h3,{id:"signature-schemes",children:"Signature Schemes"}),"\n",(0,n.jsxs)(i.p,{children:[(0,n.jsx)(i.strong,{children:"ECDSA"})," (original):"]}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsx)(i.li,{children:"Used for legacy and SegWit v0 transactions"}),"\n",(0,n.jsx)(i.li,{children:"Signatures are ~72 bytes (DER encoded)"}),"\n",(0,n.jsx)(i.li,{children:"Not natively aggregatable"}),"\n"]}),"\n",(0,n.jsxs)(i.p,{children:[(0,n.jsx)(i.strong,{children:"Schnorr"})," (Taproot, BIP-340):"]}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsx)(i.li,{children:"Simpler mathematical structure"}),"\n",(0,n.jsx)(i.li,{children:"Fixed 64-byte signatures"}),"\n",(0,n.jsx)(i.li,{children:"Supports key aggregation (MuSig2) \u2014 multiple signers produce a single signature"}),"\n",(0,n.jsx)(i.li,{children:"Batch verification is more efficient"}),"\n"]}),"\n",(0,n.jsx)(i.h3,{id:"tagged-hashes",children:"Tagged Hashes"}),"\n",(0,n.jsxs)(i.p,{children:["Taproot introduced ",(0,n.jsx)(i.strong,{children:"tagged hashes"})," to prevent cross-protocol attacks:"]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:"tagged_hash(tag, msg) = SHA256(SHA256(tag) || SHA256(tag) || msg)\n"})}),"\n",(0,n.jsxs)(i.p,{children:["Each context uses a different tag (",(0,n.jsx)(i.code,{children:"TapLeaf"}),", ",(0,n.jsx)(i.code,{children:"TapBranch"}),", ",(0,n.jsx)(i.code,{children:"TapTweak"}),", etc.), ensuring a hash from one context can't be reinterpreted in another."]}),"\n",(0,n.jsx)(i.h2,{id:"security-practices-in-bitcoin-core",children:"Security Practices in Bitcoin Core"}),"\n",(0,n.jsx)(i.h3,{id:"responsible-disclosure",children:"Responsible Disclosure"}),"\n",(0,n.jsxs)(i.p,{children:["Bitcoin Core has a ",(0,n.jsx)(i.a,{href:"https://github.com/bitcoin/bitcoin/blob/master/SECURITY.md",children:"security policy"}),":"]}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsxs)(i.li,{children:["Critical bugs are reported privately to ",(0,n.jsx)(i.a,{href:"mailto:security@bitcoincore.org",children:"security@bitcoincore.org"})]}),"\n",(0,n.jsx)(i.li,{children:"Fixes are coordinated before public disclosure"}),"\n",(0,n.jsx)(i.li,{children:"CVEs are assigned for tracked vulnerabilities"}),"\n"]}),"\n",(0,n.jsx)(i.h3,{id:"defensive-programming",children:"Defensive Programming"}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"No dynamic memory allocation in consensus code"})," where avoidable"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Overflow checks"})," on all arithmetic operations"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Constant-time operations"})," for cryptographic code (prevent timing attacks)"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Minimal dependencies"})," \u2014 fewer external libraries = smaller attack surface"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Deterministic builds"})," (Guix) \u2014 verify that binaries match source code"]}),"\n"]}),"\n",(0,n.jsx)(i.h2,{id:"recommended-reading",children:"Recommended Reading"}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsx)(i.li,{children:(0,n.jsx)(i.a,{href:"https://blog.lopp.net/bitcoin-security-model/",children:"Bitcoin Security Model (Lopp)"})}),"\n",(0,n.jsx)(i.li,{children:(0,n.jsx)(i.a,{href:"https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch04_keys.adoc",children:"Mastering Bitcoin, Ch. 4: Keys and Addresses"})}),"\n",(0,n.jsx)(i.li,{children:(0,n.jsx)(i.a,{href:"https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki",children:"BIP-340: Schnorr Signatures"})}),"\n",(0,n.jsx)(i.li,{children:(0,n.jsx)(i.a,{href:"https://andrea.corbellini.name/2015/05/17/elliptic-curve-cryptography-a-gentle-introduction/",children:"Elliptic Curve Cryptography (Andrea Corbellini)"})}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,n.jsx)(i,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}},8453(e,i,r){r.d(i,{R:()=>c,x:()=>o});var t=r(6540);const n={},s=t.createContext(n);function c(e){const i=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:c(e.components),t.createElement(s.Provider,{value:i},e.children)}}}]);