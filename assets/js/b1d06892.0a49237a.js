"use strict";(globalThis.webpackChunkbtc_dev_journey=globalThis.webpackChunkbtc_dev_journey||[]).push([[5607],{24(e,n,i){i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"fundamentals/bitcoin-architecture/index","title":"Bitcoin Architecture","description":"Understanding the UTXO model, transactions, and Bitcoin Script","source":"@site/docs/fundamentals/02-bitcoin-architecture/index.md","sourceDirName":"fundamentals/02-bitcoin-architecture","slug":"/fundamentals/bitcoin-architecture/","permalink":"/docs/fundamentals/bitcoin-architecture/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Bitcoin Architecture","description":"Understanding the UTXO model, transactions, and Bitcoin Script"},"sidebar":"guideSidebar","previous":{"title":"Bitcoin Fundamentals","permalink":"/docs/fundamentals/bitcoin-fundamentals/"},"next":{"title":"P2P Network","permalink":"/docs/fundamentals/p2p-network/"}}');var s=i(4848),r=i(8453);const c={sidebar_position:3,title:"Bitcoin Architecture",description:"Understanding the UTXO model, transactions, and Bitcoin Script"},d="Bitcoin Architecture",o={},a=[{value:"The UTXO Model",id:"the-utxo-model",level:2},{value:"How It Works",id:"how-it-works",level:3},{value:"Why UTXOs Matter for Developers",id:"why-utxos-matter-for-developers",level:3},{value:"Transactions",id:"transactions",level:2},{value:"Inputs",id:"inputs",level:3},{value:"Outputs",id:"outputs",level:3},{value:"Transaction Types",id:"transaction-types",level:3},{value:"SegWit and Taproot",id:"segwit-and-taproot",level:3},{value:"Bitcoin Script",id:"bitcoin-script",level:2},{value:"How Script Works",id:"how-script-works",level:3},{value:"Common Opcodes",id:"common-opcodes",level:3},{value:"Example: P2PKH Script Execution",id:"example-p2pkh-script-execution",level:3},{value:"Recommended Reading",id:"recommended-reading",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"bitcoin-architecture",children:"Bitcoin Architecture"})}),"\n",(0,s.jsx)(n.p,{children:"This section covers Bitcoin's core data structures: how value is represented, how transactions work, and how Bitcoin's scripting language enables programmable money."}),"\n",(0,s.jsx)(n.h2,{id:"the-utxo-model",children:"The UTXO Model"}),"\n",(0,s.jsxs)(n.p,{children:["Bitcoin doesn't use accounts and balances like a bank. Instead, it uses ",(0,s.jsx)(n.strong,{children:"UTXOs"})," (Unspent Transaction Outputs)."]}),"\n",(0,s.jsx)(n.h3,{id:"how-it-works",children:"How It Works"}),"\n",(0,s.jsx)(n.p,{children:'Think of UTXOs like physical coins and bills. When you "have" 1.5 BTC, you don\'t have an account with a 1.5 BTC balance \u2014 you have one or more UTXOs that add up to 1.5 BTC. For example:'}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"UTXO A: 1.0 BTC (from a payment you received)"}),"\n",(0,s.jsx)(n.li,{children:"UTXO B: 0.5 BTC (change from a previous transaction)"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["When you spend Bitcoin, you ",(0,s.jsx)(n.strong,{children:"consume"})," entire UTXOs as inputs and create new UTXOs as outputs:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Inputs (consumed):          Outputs (created):\n  UTXO A: 1.0 BTC    \u2192       0.7 BTC to recipient\n                              0.2999 BTC back to you (change)\n                              0.0001 BTC fee (implicit)\n"})}),"\n",(0,s.jsxs)(n.p,{children:["The input UTXO is destroyed. Two new UTXOs are created: one for the recipient, one as change back to you. The difference between inputs and outputs is the ",(0,s.jsx)(n.strong,{children:"transaction fee"})," paid to miners."]}),"\n",(0,s.jsx)(n.h3,{id:"why-utxos-matter-for-developers",children:"Why UTXOs Matter for Developers"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Privacy"}),' \u2014 Each UTXO is independent; no single "balance" is exposed']}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Parallelism"})," \u2014 UTXOs can be spent independently, enabling parallel validation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Coin selection"})," \u2014 Wallets must choose which UTXOs to spend (a non-trivial algorithm)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Dust"})," \u2014 Very small UTXOs cost more in fees to spend than they're worth"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"transactions",children:"Transactions"}),"\n",(0,s.jsx)(n.p,{children:"A Bitcoin transaction is a data structure with:"}),"\n",(0,s.jsx)(n.h3,{id:"inputs",children:"Inputs"}),"\n",(0,s.jsxs)(n.p,{children:["Each input references a previous transaction output (by txid and output index) and provides a ",(0,s.jsx)(n.strong,{children:"script"})," that satisfies the spending conditions:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'{\n  "txid": "abc123...",\n  "vout": 0,\n  "scriptSig": "<signature> <pubkey>"\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"outputs",children:"Outputs"}),"\n",(0,s.jsxs)(n.p,{children:["Each output specifies an amount and a ",(0,s.jsx)(n.strong,{children:"locking script"})," (the conditions that must be met to spend it):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'{\n  "value": 0.5,\n  "scriptPubKey": "OP_DUP OP_HASH160 <pubkeyhash> OP_EQUALVERIFY OP_CHECKSIG"\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"transaction-types",children:"Transaction Types"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Common Use"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"P2PKH"})}),(0,s.jsx)(n.td,{children:"Pay to Public Key Hash"}),(0,s.jsx)(n.td,{children:"Legacy addresses (1...)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"P2SH"})}),(0,s.jsx)(n.td,{children:"Pay to Script Hash"}),(0,s.jsx)(n.td,{children:"Multisig, wrapped SegWit (3...)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"P2WPKH"})}),(0,s.jsx)(n.td,{children:"Pay to Witness Public Key Hash"}),(0,s.jsx)(n.td,{children:"Native SegWit (bc1q...)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"P2WSH"})}),(0,s.jsx)(n.td,{children:"Pay to Witness Script Hash"}),(0,s.jsx)(n.td,{children:"SegWit multisig"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"P2TR"})}),(0,s.jsx)(n.td,{children:"Pay to Taproot"}),(0,s.jsx)(n.td,{children:"Taproot addresses (bc1p...)"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"segwit-and-taproot",children:"SegWit and Taproot"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Segregated Witness (SegWit)"}),', activated in 2017, moved signature data to a separate "witness" structure. This fixed transaction malleability and effectively increased block capacity.']}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Taproot"}),", activated in 2021, introduced Schnorr signatures and MAST (Merkelized Alternative Script Trees). This improves privacy (complex scripts look like simple payments) and efficiency."]}),"\n",(0,s.jsx)(n.h2,{id:"bitcoin-script",children:"Bitcoin Script"}),"\n",(0,s.jsx)(n.p,{children:"Bitcoin has its own scripting language \u2014 a simple, stack-based, intentionally non-Turing-complete language for defining spending conditions."}),"\n",(0,s.jsx)(n.h3,{id:"how-script-works",children:"How Script Works"}),"\n",(0,s.jsxs)(n.p,{children:["When a transaction is validated, the ",(0,s.jsx)(n.strong,{children:"unlocking script"})," (scriptSig/witness) is combined with the ",(0,s.jsx)(n.strong,{children:"locking script"})," (scriptPubKey) and executed on a stack machine. If the execution succeeds (leaves ",(0,s.jsx)(n.code,{children:"true"})," on the stack), the spend is valid."]}),"\n",(0,s.jsx)(n.h3,{id:"common-opcodes",children:"Common Opcodes"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Opcode"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OP_DUP"})}),(0,s.jsx)(n.td,{children:"Duplicate the top stack item"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OP_HASH160"})}),(0,s.jsx)(n.td,{children:"Hash the top item with SHA-256 then RIPEMD-160"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OP_EQUALVERIFY"})}),(0,s.jsx)(n.td,{children:"Check equality, fail if not equal"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OP_CHECKSIG"})}),(0,s.jsx)(n.td,{children:"Verify a signature against a public key"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OP_CHECKMULTISIG"})}),(0,s.jsx)(n.td,{children:"Verify M-of-N multisig"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OP_CHECKLOCKTIMEVERIFY"})}),(0,s.jsx)(n.td,{children:"Time-lock: output can't be spent before a time/block"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OP_CHECKSEQUENCEVERIFY"})}),(0,s.jsx)(n.td,{children:"Relative time-lock"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"OP_IF / OP_ELSE / OP_ENDIF"})}),(0,s.jsx)(n.td,{children:"Conditional execution"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"example-p2pkh-script-execution",children:"Example: P2PKH Script Execution"}),"\n",(0,s.jsxs)(n.p,{children:["Locking script: ",(0,s.jsx)(n.code,{children:"OP_DUP OP_HASH160 <pubKeyHash> OP_EQUALVERIFY OP_CHECKSIG"})]}),"\n",(0,s.jsxs)(n.p,{children:["Unlocking script: ",(0,s.jsx)(n.code,{children:"<sig> <pubKey>"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Stack execution:\n1. Push <sig>           \u2192 [sig]\n2. Push <pubKey>        \u2192 [sig, pubKey]\n3. OP_DUP               \u2192 [sig, pubKey, pubKey]\n4. OP_HASH160            \u2192 [sig, pubKey, hash(pubKey)]\n5. Push <pubKeyHash>    \u2192 [sig, pubKey, hash(pubKey), pubKeyHash]\n6. OP_EQUALVERIFY        \u2192 [sig, pubKey]  (hashes match \u2713)\n7. OP_CHECKSIG           \u2192 [true]         (signature valid \u2713)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"recommended-reading",children:"Recommended Reading"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://learnmeabitcoin.com/",children:"Learn Me a Bitcoin"})," \u2014 Visual explanations of transactions and script"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://en.bitcoin.it/wiki/Script",children:"Bitcoin Script Wiki"})," \u2014 Complete opcode reference"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/bitcoin/bips/blob/master/bip-0141.mediawiki",children:"BIP-141 (SegWit)"})," \u2014 Segregated Witness specification"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/bitcoin/bips/blob/master/bip-0341.mediawiki",children:"BIP-341 (Taproot)"})," \u2014 Taproot specification"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453(e,n,i){i.d(n,{R:()=>c,x:()=>d});var t=i(6540);const s={},r=t.createContext(s);function c(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);