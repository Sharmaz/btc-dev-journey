"use strict";(globalThis.webpackChunkbtc_dev_journey=globalThis.webpackChunkbtc_dev_journey||[]).push([[5024],{156(e,i,n){n.r(i),n.d(i,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"tracks/application-developer/wallet-development/index","title":"Wallet Development","description":"Building Bitcoin wallets - HD key derivation, coin selection, and key management","source":"@site/docs/tracks/application-developer/02-wallet-development/index.md","sourceDirName":"tracks/application-developer/02-wallet-development","slug":"/tracks/application-developer/wallet-development/","permalink":"/docs/tracks/application-developer/wallet-development/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Wallet Development","description":"Building Bitcoin wallets - HD key derivation, coin selection, and key management"},"sidebar":"guideSidebar","previous":{"title":"Go","permalink":"/docs/tracks/application-developer/libraries-sdks/go"},"next":{"title":"Payment Processing","permalink":"/docs/tracks/application-developer/payment-processing/"}}');var t=n(4848),r=n(8453);const l={sidebar_position:2,title:"Wallet Development",description:"Building Bitcoin wallets - HD key derivation, coin selection, and key management"},d="Wallet Development",a={},c=[{value:"HD Wallets (Hierarchical Deterministic)",id:"hd-wallets-hierarchical-deterministic",level:2},{value:"BIP-32: HD Key Derivation",id:"bip-32-hd-key-derivation",level:3},{value:"BIP-39: Mnemonic Seed Phrases",id:"bip-39-mnemonic-seed-phrases",level:3},{value:"BIP-44/49/84/86: Derivation Paths",id:"bip-44498486-derivation-paths",level:3},{value:"Descriptors",id:"descriptors",level:2},{value:"Coin Selection",id:"coin-selection",level:2},{value:"Strategies",id:"strategies",level:3},{value:"Considerations",id:"considerations",level:3},{value:"PSBT (Partially Signed Bitcoin Transactions)",id:"psbt-partially-signed-bitcoin-transactions",level:2},{value:"Security Considerations",id:"security-considerations",level:2},{value:"Recommended Reading",id:"recommended-reading",level:2}];function o(e){const i={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.header,{children:(0,t.jsx)(i.h1,{id:"wallet-development",children:"Wallet Development"})}),"\n",(0,t.jsx)(i.p,{children:"A Bitcoin wallet is much more than a balance display. It manages keys, constructs transactions, selects which UTXOs to spend, estimates fees, and keeps track of your transaction history. Building a secure wallet is one of the most important (and challenging) tasks in Bitcoin development."}),"\n",(0,t.jsx)(i.h2,{id:"hd-wallets-hierarchical-deterministic",children:"HD Wallets (Hierarchical Deterministic)"}),"\n",(0,t.jsx)(i.p,{children:"Modern wallets use a tree structure to derive all keys from a single seed:"}),"\n",(0,t.jsx)(i.h3,{id:"bip-32-hd-key-derivation",children:"BIP-32: HD Key Derivation"}),"\n",(0,t.jsx)(i.p,{children:"A master seed generates a tree of key pairs:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"Master Seed\n  \u2514\u2500\u2500 m (master key)\n       \u251c\u2500\u2500 m/0  (child 0)\n       \u2502    \u251c\u2500\u2500 m/0/0\n       \u2502    \u2514\u2500\u2500 m/0/1\n       \u2514\u2500\u2500 m/1  (child 1)\n            \u251c\u2500\u2500 m/1/0\n            \u2514\u2500\u2500 m/1/1\n"})}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.strong,{children:"Hardened vs. normal derivation:"})}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Normal (",(0,t.jsx)(i.code,{children:"m/0/1"}),"): Child public keys can be derived from the parent public key"]}),"\n",(0,t.jsxs)(i.li,{children:["Hardened (",(0,t.jsx)(i.code,{children:"m/0'/1'"}),"): Requires the parent private key \u2014 more secure"]}),"\n"]}),"\n",(0,t.jsx)(i.h3,{id:"bip-39-mnemonic-seed-phrases",children:"BIP-39: Mnemonic Seed Phrases"}),"\n",(0,t.jsx)(i.p,{children:"The 12 or 24-word phrases that back up a wallet:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"abandon abandon abandon ... about  \u2192  Entropy  \u2192  Seed  \u2192  Master Key\n"})}),"\n",(0,t.jsx)(i.p,{children:"The mnemonic encodes entropy (128 or 256 bits) with a checksum. Combined with an optional passphrase, it produces the master seed."}),"\n",(0,t.jsx)(i.h3,{id:"bip-44498486-derivation-paths",children:"BIP-44/49/84/86: Derivation Paths"}),"\n",(0,t.jsx)(i.p,{children:"Standard paths define where keys live in the HD tree:"}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"BIP"}),(0,t.jsx)(i.th,{children:"Path"}),(0,t.jsx)(i.th,{children:"Address Type"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"BIP-44"}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"m/44'/0'/0'/0/i"})}),(0,t.jsx)(i.td,{children:"Legacy P2PKH (1...)"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"BIP-49"}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"m/49'/0'/0'/0/i"})}),(0,t.jsx)(i.td,{children:"Wrapped SegWit P2SH-P2WPKH (3...)"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"BIP-84"}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"m/84'/0'/0'/0/i"})}),(0,t.jsx)(i.td,{children:"Native SegWit P2WPKH (bc1q...)"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:"BIP-86"}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"m/86'/0'/0'/0/i"})}),(0,t.jsx)(i.td,{children:"Taproot P2TR (bc1p...)"})]})]})]}),"\n",(0,t.jsxs)(i.p,{children:["Path components: ",(0,t.jsx)(i.code,{children:"purpose' / coin_type' / account' / change / address_index"})]}),"\n",(0,t.jsx)(i.h2,{id:"descriptors",children:"Descriptors"}),"\n",(0,t.jsx)(i.p,{children:"Output descriptors are a modern way to describe what a wallet can spend:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"# Native SegWit wallet\nwpkh([fingerprint/84'/0'/0']xpub.../0/*)\n\n# 2-of-3 multisig\nwsh(sortedmulti(2, [fp1/48'/0'/0'/2']xpub1/0/*, [fp2/...]xpub2/0/*, [fp3/...]xpub3/0/*))\n\n# Taproot\ntr([fingerprint/86'/0'/0']xpub.../0/*)\n"})}),"\n",(0,t.jsx)(i.p,{children:"Descriptors are the preferred approach for new wallet implementations. BDK is built entirely around descriptors."}),"\n",(0,t.jsx)(i.h2,{id:"coin-selection",children:"Coin Selection"}),"\n",(0,t.jsx)(i.p,{children:"When spending Bitcoin, the wallet must choose which UTXOs to use as inputs. This is non-trivial:"}),"\n",(0,t.jsx)(i.h3,{id:"strategies",children:"Strategies"}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Strategy"}),(0,t.jsx)(i.th,{children:"Description"}),(0,t.jsx)(i.th,{children:"Trade-off"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Largest first"})}),(0,t.jsx)(i.td,{children:"Use biggest UTXOs first"}),(0,t.jsx)(i.td,{children:"Simple, but creates many small change outputs"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Smallest first"})}),(0,t.jsx)(i.td,{children:"Use smallest UTXOs first"}),(0,t.jsx)(i.td,{children:"Consolidates dust, but higher fees"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Branch and Bound"})}),(0,t.jsx)(i.td,{children:"Find exact match (no change)"}),(0,t.jsx)(i.td,{children:"Optimal when possible, computationally expensive"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Random"})}),(0,t.jsx)(i.td,{children:"Random selection with target"}),(0,t.jsx)(i.td,{children:"Good privacy, unpredictable"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.strong,{children:"Knapsack"})}),(0,t.jsx)(i.td,{children:"Approximate target with minimal waste"}),(0,t.jsx)(i.td,{children:"Bitcoin Core's historical approach"})]})]})]}),"\n",(0,t.jsx)(i.h3,{id:"considerations",children:"Considerations"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Fee minimization"})," \u2014 Fewer inputs = lower fee"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Privacy"})," \u2014 Avoid linking UTXOs from different sources"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Change output"})," \u2014 Extra output costs ~34 bytes; avoid if possible"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Dust avoidance"})," \u2014 Don't create change below dust threshold (~546 sats)"]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"psbt-partially-signed-bitcoin-transactions",children:"PSBT (Partially Signed Bitcoin Transactions)"}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.a,{href:"https://github.com/bitcoin/bips/blob/master/bip-0174.mediawiki",children:"BIP-174"})," defines a standard format for unsigned/partially signed transactions. This enables:"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Hardware wallet signing"})," \u2014 Create transaction on computer, sign on device"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Multisig workflows"})," \u2014 Each signer adds their signature independently"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"CoinJoin"})," \u2014 Multiple parties contribute inputs and sign separately"]}),"\n"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"Creator \u2192 Updater \u2192 Signer \u2192 Combiner \u2192 Finalizer \u2192 Extractor\n"})}),"\n",(0,t.jsx)(i.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Never store private keys in plaintext"})," \u2014 Encrypt at rest"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Use hardware wallets for significant funds"})," \u2014 Keys never leave the device"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Implement address verification"})," \u2014 Display addresses on hardware device"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Test on regtest/testnet first"})," \u2014 Always test before mainnet"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Backup the seed phrase securely"})," \u2014 Metal backup, multiple locations"]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"recommended-reading",children:"Recommended Reading"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.a,{href:"https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki",children:"BIP-32: HD Wallets"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.a,{href:"https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki",children:"BIP-39: Mnemonic Code"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.a,{href:"https://github.com/bitcoin/bitcoin/blob/master/doc/descriptors.md",children:"Output Descriptors (Bitcoin Core)"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.a,{href:"https://github.com/bitcoin/bips/blob/master/bip-0174.mediawiki",children:"BIP-174: PSBT"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.a,{href:"https://bitcoin.design/guide/designing-products/personal-finance/",children:"Bitcoin Design Guide: Wallet"})}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},8453(e,i,n){n.d(i,{R:()=>l,x:()=>d});var s=n(6540);const t={},r=s.createContext(t);function l(e){const i=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function d(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:i},e.children)}}}]);