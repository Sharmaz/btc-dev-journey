"use strict";(globalThis.webpackChunkbtc_dev_journey=globalThis.webpackChunkbtc_dev_journey||[]).push([[6260],{4338(e,i,n){n.r(i),n.d(i,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"cross-cutting/smart-contracts/index","title":"Smart Contracts","description":"Smart contract capabilities on Bitcoin - Script, Miniscript, Tapscript, DLCs, and covenants","source":"@site/docs/cross-cutting/smart-contracts/index.md","sourceDirName":"cross-cutting/smart-contracts","slug":"/cross-cutting/smart-contracts/","permalink":"/docs/cross-cutting/smart-contracts/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Smart Contracts","description":"Smart contract capabilities on Bitcoin - Script, Miniscript, Tapscript, DLCs, and covenants"},"sidebar":"guideSidebar","previous":{"title":"Sidechains & Layer 2","permalink":"/docs/cross-cutting/sidechains-l2/"},"next":{"title":"Books","permalink":"/docs/resources/books"}}');var s=n(4848),r=n(8453);const c={sidebar_position:4,title:"Smart Contracts",description:"Smart contract capabilities on Bitcoin - Script, Miniscript, Tapscript, DLCs, and covenants"},o="Smart Contracts on Bitcoin",l={},a=[{value:"Bitcoin Script",id:"bitcoin-script",level:2},{value:"What You Can Do Today",id:"what-you-can-do-today",level:3},{value:"Miniscript",id:"miniscript",level:2},{value:"Why Miniscript Matters",id:"why-miniscript-matters",level:3},{value:"Taproot &amp; Tapscript",id:"taproot--tapscript",level:2},{value:"MAST (Merkelized Alternative Script Trees)",id:"mast-merkelized-alternative-script-trees",level:3},{value:"Tapscript",id:"tapscript",level:3},{value:"Discreet Log Contracts (DLCs)",id:"discreet-log-contracts-dlcs",level:2},{value:"Covenants (Proposed)",id:"covenants-proposed",level:2},{value:"OP_CHECKTEMPLATEVERIFY (CTV) \u2014 BIP-119",id:"op_checktemplateverify-ctv--bip-119",level:3},{value:"OP_CAT",id:"op_cat",level:3},{value:"BitVM",id:"bitvm",level:3},{value:"The Bitcoin Smart Contract Philosophy",id:"the-bitcoin-smart-contract-philosophy",level:2},{value:"Recommended Reading",id:"recommended-reading",level:2}];function d(e){const i={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.header,{children:(0,s.jsx)(i.h1,{id:"smart-contracts-on-bitcoin",children:"Smart Contracts on Bitcoin"})}),"\n",(0,s.jsx)(i.p,{children:"Bitcoin has always had smart contracts \u2014 they're just different from what you might expect. Bitcoin's approach prioritizes security, predictability, and minimalism over expressiveness. Every Bitcoin transaction is a smart contract."}),"\n",(0,s.jsxs)(i.p,{children:["For related topics, see ",(0,s.jsx)(i.a,{href:"/docs/tracks/application-developer/web3-bitcoin",children:"Web3 on Bitcoin"})," and ",(0,s.jsx)(i.a,{href:"/docs/tracks/application-developer/advanced-protocols",children:"Advanced Protocols"}),"."]}),"\n",(0,s.jsx)(i.h2,{id:"bitcoin-script",children:"Bitcoin Script"}),"\n",(0,s.jsxs)(i.p,{children:["Bitcoin's native scripting language is ",(0,s.jsx)(i.strong,{children:"stack-based and intentionally non-Turing-complete"}),". This is a feature, not a limitation:"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Predictable execution"})," \u2014 No infinite loops, bounded resource usage"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Simple verification"})," \u2014 Easy to reason about what a script does"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Security"})," \u2014 Smaller attack surface than general-purpose VMs"]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"what-you-can-do-today",children:"What You Can Do Today"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"Capability"}),(0,s.jsx)(i.th,{children:"Mechanism"}),(0,s.jsx)(i.th,{children:"Example Use"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"Multi-party signing"})}),(0,s.jsx)(i.td,{children:"OP_CHECKMULTISIG, MuSig2"}),(0,s.jsx)(i.td,{children:"Shared wallets, escrow"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"Time-locked payments"})}),(0,s.jsx)(i.td,{children:"OP_CLTV, OP_CSV"}),(0,s.jsx)(i.td,{children:"Inheritance, scheduled releases"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"Hash-locked payments"})}),(0,s.jsx)(i.td,{children:"OP_HASH160 + OP_EQUAL"}),(0,s.jsx)(i.td,{children:"HTLCs (Lightning, atomic swaps)"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"Conditional execution"})}),(0,s.jsx)(i.td,{children:"OP_IF / OP_ELSE"}),(0,s.jsx)(i.td,{children:"Multiple spending paths"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:(0,s.jsx)(i.strong,{children:"Signature verification"})}),(0,s.jsx)(i.td,{children:"OP_CHECKSIG, OP_CHECKSIGADD"}),(0,s.jsx)(i.td,{children:"Authorization"})]})]})]}),"\n",(0,s.jsx)(i.h2,{id:"miniscript",children:"Miniscript"}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.a,{href:"https://bitcoin.sipa.be/miniscript/",children:"Miniscript"})," is a structured subset of Bitcoin Script that enables ",(0,s.jsx)(i.strong,{children:"composable spending policies"}),":"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"Policy: thresh(2, pk(Alice), pk(Bob), pk(Carol))\nResult: 2-of-3 multisig\n\nPolicy: or(pk(Alice), and(pk(Bob), after(144)))\nResult: Alice can spend anytime, OR Bob can spend after 144 blocks\n"})}),"\n",(0,s.jsx)(i.h3,{id:"why-miniscript-matters",children:"Why Miniscript Matters"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Composability"})," \u2014 Combine conditions with AND, OR, THRESHOLD"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Analysis"})," \u2014 Automatically determine witness size, spending conditions"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Compilation"})," \u2014 Policy \u2192 optimized Bitcoin Script automatically"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Interoperability"})," \u2014 Wallets can understand arbitrary spending policies"]}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"Miniscript is integrated into Bitcoin Core's wallet and is the foundation of descriptor-based wallets."}),"\n",(0,s.jsx)(i.h2,{id:"taproot--tapscript",children:"Taproot & Tapscript"}),"\n",(0,s.jsx)(i.p,{children:"Taproot (BIP-341/342) significantly expanded Bitcoin's smart contract capabilities:"}),"\n",(0,s.jsx)(i.h3,{id:"mast-merkelized-alternative-script-trees",children:"MAST (Merkelized Alternative Script Trees)"}),"\n",(0,s.jsx)(i.p,{children:"Multiple spending conditions organized in a Merkle tree. Only the used condition is revealed on-chain:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"                    [Taproot Key]\n                    /           \\\n            [Branch A]       [Branch B]\n            /        \\           |\n    [2-of-3 multisig] [Timelock] [Emergency recovery]\n"})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Privacy"})," \u2014 Unused branches are never revealed"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Efficiency"})," \u2014 Only the executed branch goes on-chain"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Key path spending"})," \u2014 The most common case (simple key spend) looks like any other Taproot payment"]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"tapscript",children:"Tapscript"}),"\n",(0,s.jsx)(i.p,{children:"Tapscript is the script version used inside Taproot, with improvements:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"OP_CHECKSIGADD"})," replaces ",(0,s.jsx)(i.code,{children:"OP_CHECKMULTISIG"})," (more efficient)"]}),"\n",(0,s.jsx)(i.li,{children:"Signature validation uses Schnorr"}),"\n",(0,s.jsxs)(i.li,{children:["Future opcodes can be added via ",(0,s.jsx)(i.code,{children:"OP_SUCCESSx"})]}),"\n"]}),"\n",(0,s.jsx)(i.h2,{id:"discreet-log-contracts-dlcs",children:"Discreet Log Contracts (DLCs)"}),"\n",(0,s.jsx)(i.p,{children:"DLCs enable oracle-based conditional payments without revealing the contract on-chain:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{children:"1. Alice and Bob agree on a contract (e.g., BTC price > $100k on date X)\n2. They lock funds in a 2-of-2 multisig\n3. Oracle publishes a signed attestation of the outcome\n4. Winner uses the attestation to claim funds\n"})}),"\n",(0,s.jsx)(i.p,{children:"The oracle never learns about the contract. Multiple oracles can be used for trust minimization."}),"\n",(0,s.jsxs)(i.p,{children:[(0,s.jsx)(i.strong,{children:"Libraries:"})," ",(0,s.jsx)(i.a,{href:"https://github.com/p2pderivatives/rust-dlc",children:"rust-dlc"}),", ",(0,s.jsx)(i.a,{href:"https://github.com/bennyhodl/dlcdevkit",children:"dlcdevkit"})]}),"\n",(0,s.jsx)(i.h2,{id:"covenants-proposed",children:"Covenants (Proposed)"}),"\n",(0,s.jsxs)(i.p,{children:["Covenants would restrict ",(0,s.jsx)(i.strong,{children:"how"})," a UTXO can be spent, not just ",(0,s.jsx)(i.strong,{children:"who"})," can spend it. They're the most active area of Bitcoin smart contract research."]}),"\n",(0,s.jsx)(i.h3,{id:"op_checktemplateverify-ctv--bip-119",children:"OP_CHECKTEMPLATEVERIFY (CTV) \u2014 BIP-119"}),"\n",(0,s.jsx)(i.p,{children:"Commits to the exact transaction that will spend an output:"}),"\n",(0,s.jsx)(i.p,{children:(0,s.jsx)(i.strong,{children:"Use cases:"})}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Vaults"})," \u2014 Withdrawal delays with emergency clawback"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Congestion control"})," \u2014 Batch payouts that expand later"]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"Payment pools"})," \u2014 Shared UTXOs for multiple users"]}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"op_cat",children:"OP_CAT"}),"\n",(0,s.jsx)(i.p,{children:"Re-enables the concatenation opcode (disabled by Satoshi in 2010). Combined with Schnorr signatures, enables surprisingly powerful contract logic:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Vault constructions"}),"\n",(0,s.jsx)(i.li,{children:"Arbitrary transaction introspection"}),"\n",(0,s.jsx)(i.li,{children:"Merkle proof verification in script"}),"\n"]}),"\n",(0,s.jsx)(i.h3,{id:"bitvm",children:"BitVM"}),"\n",(0,s.jsxs)(i.p,{children:["An ",(0,s.jsx)(i.strong,{children:"optimistic computation"})," model for Bitcoin \u2014 arbitrary programs can be verified on Bitcoin without a soft fork:"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Prover commits to computation result"}),"\n",(0,s.jsx)(i.li,{children:"Verifier can challenge via on-chain dispute"}),"\n",(0,s.jsx)(i.li,{children:"Only incorrect results require on-chain resolution"}),"\n"]}),"\n",(0,s.jsx)(i.p,{children:"Still in research/early development, but potentially transformative."}),"\n",(0,s.jsx)(i.h2,{id:"the-bitcoin-smart-contract-philosophy",children:"The Bitcoin Smart Contract Philosophy"}),"\n",(0,s.jsx)(i.p,{children:"Bitcoin's approach is fundamentally different from Ethereum:"}),"\n",(0,s.jsxs)(i.table,{children:[(0,s.jsx)(i.thead,{children:(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.th,{children:"Bitcoin"}),(0,s.jsx)(i.th,{children:"Ethereum"})]})}),(0,s.jsxs)(i.tbody,{children:[(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Verify, don't compute"}),(0,s.jsx)(i.td,{children:"Compute on-chain"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Non-Turing-complete"}),(0,s.jsx)(i.td,{children:"Turing-complete"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"UTXO model"}),(0,s.jsx)(i.td,{children:"Account model"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Off-chain execution preferred"}),(0,s.jsx)(i.td,{children:"On-chain execution standard"})]}),(0,s.jsxs)(i.tr,{children:[(0,s.jsx)(i.td,{children:"Minimal, secure"}),(0,s.jsx)(i.td,{children:"Expressive, larger attack surface"})]})]})]}),"\n",(0,s.jsxs)(i.p,{children:["The Bitcoin philosophy: ",(0,s.jsx)(i.strong,{children:"move complexity off-chain, use the blockchain only for settlement and dispute resolution."})]}),"\n",(0,s.jsx)(i.h2,{id:"recommended-reading",children:"Recommended Reading"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://bitcoin.sipa.be/miniscript/",children:"Miniscript (Pieter Wuille)"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://github.com/bitcoin/bips/blob/master/bip-0341.mediawiki",children:"BIP-341: Taproot"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://github.com/bitcoin/bips/blob/master/bip-0119.mediawiki",children:"BIP-119: OP_CTV"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://bitvm.org/bitvm.pdf",children:"BitVM Whitepaper"})}),"\n",(0,s.jsx)(i.li,{children:(0,s.jsx)(i.a,{href:"https://github.com/discreetlogcontracts/dlcspecs",children:"DLC Specification"})}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453(e,i,n){n.d(i,{R:()=>c,x:()=>o});var t=n(6540);const s={},r=t.createContext(s);function c(e){const i=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),t.createElement(r.Provider,{value:i},e.children)}}}]);