"use strict";(globalThis.webpackChunkbtc_dev_journey=globalThis.webpackChunkbtc_dev_journey||[]).push([[6117],{4033(e,n,i){i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"tracks/application-developer/payment-processing/index","title":"Procesamiento de Pagos","description":"Construyendo flujos de pago, sistemas de facturaci\xf3n e integraci\xf3n con Lightning Network","source":"@site/i18n/es/docusaurus-plugin-content-docs/current/tracks/application-developer/03-payment-processing/index.md","sourceDirName":"tracks/application-developer/03-payment-processing","slug":"/tracks/application-developer/payment-processing/","permalink":"/es/docs/tracks/application-developer/payment-processing/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Procesamiento de Pagos","description":"Construyendo flujos de pago, sistemas de facturaci\xf3n e integraci\xf3n con Lightning Network"},"sidebar":"guideSidebar","previous":{"title":"Desarrollo de Wallets","permalink":"/es/docs/tracks/application-developer/wallet-development/"},"next":{"title":"Exchange y Trading","permalink":"/es/docs/tracks/application-developer/exchange-trading/"}}');var r=i(4848),o=i(8453);const a={sidebar_position:3,title:"Procesamiento de Pagos",description:"Construyendo flujos de pago, sistemas de facturaci\xf3n e integraci\xf3n con Lightning Network"},c="Procesamiento de Pagos",t={},d=[{value:"Pagos On-Chain",id:"pagos-on-chain",level:2},{value:"Flujo de Pago",id:"flujo-de-pago",level:3},{value:"Consideraciones Clave",id:"consideraciones-clave",level:3},{value:"Monitoreo de Pagos",id:"monitoreo-de-pagos",level:3},{value:"Pagos Lightning",id:"pagos-lightning",level:2},{value:"Facturas BOLT-11",id:"facturas-bolt-11",level:3},{value:"Flujo de Pago (Lightning)",id:"flujo-de-pago-lightning",level:3},{value:"Opciones de Integraci\xf3n Lightning",id:"opciones-de-integraci\xf3n-lightning",level:3},{value:"BTCPay Server",id:"btcpay-server",level:2},{value:"C\xf3digos QR Unificados (BIP-21)",id:"c\xf3digos-qr-unificados-bip-21",level:2},{value:"Lectura Recomendada",id:"lectura-recomendada",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"procesamiento-de-pagos",children:"Procesamiento de Pagos"})}),"\n",(0,r.jsx)(n.p,{children:"Aceptar pagos en Bitcoin implica m\xe1s que solo generar una direcci\xf3n. Necesitas manejar confirmaciones, estimaci\xf3n de comisiones, detecci\xf3n de pagos, y cada vez m\xe1s, integraci\xf3n con Lightning Network para pagos instant\xe1neos."}),"\n",(0,r.jsx)(n.h2,{id:"pagos-on-chain",children:"Pagos On-Chain"}),"\n",(0,r.jsx)(n.h3,{id:"flujo-de-pago",children:"Flujo de Pago"}),"\n",(0,r.jsx)(n.mermaid,{value:"graph LR\n    A[Generar Direcci\xf3n] --\x3e B[Mostrar al Cliente]\n    B --\x3e C[Monitorear Mempool]\n    C --\x3e D[Detectar Pago]\n    D --\x3e E[Esperar Confirmaciones]\n    E --\x3e F[Marcar como Pagado]"}),"\n",(0,r.jsx)(n.h3,{id:"consideraciones-clave",children:"Consideraciones Clave"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Factor"}),(0,r.jsx)(n.th,{children:"Recomendaci\xf3n"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Reutilizaci\xf3n de direcciones"})}),(0,r.jsx)(n.td,{children:"Nunca reutilices direcciones \u2014 genera una direcci\xf3n \xfanica por factura"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Confirmaciones"})}),(0,r.jsx)(n.td,{children:"1 confirmaci\xf3n para montos peque\xf1os, 3-6 para montos mayores"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Estimaci\xf3n de comisiones"})}),(0,r.jsxs)(n.td,{children:["Usa ",(0,r.jsx)(n.code,{children:"estimatesmartfee"})," o estimaci\xf3n basada en mempool"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Detecci\xf3n de pagos"})}),(0,r.jsx)(n.td,{children:"Vigila el mempool para 0-conf, luego rastrea confirmaciones"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Timeouts"})}),(0,r.jsx)(n.td,{children:"Establece expiraci\xf3n de factura (ej: 15-60 minutos)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Sobrepago/pago insuficiente"})}),(0,r.jsx)(n.td,{children:"Define rangos de tolerancia"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"monitoreo-de-pagos",children:"Monitoreo de Pagos"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Using bitcoin-cli\nbitcoin-cli listtransactions "*" 10  # Recent transactions\n\n# Watch a specific address (requires addressindex or wallet import)\nbitcoin-cli importaddress "bc1q..." "invoice-001" false\n'})}),"\n",(0,r.jsx)(n.p,{children:"Para producci\xf3n, usa un backend dedicado:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Electrum server"})," \u2014 Consultas eficientes basadas en direcciones"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Esplora API"})," \u2014 API REST para b\xfasquedas de direcciones/transacciones"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Bitcoin Core wallet"})," \u2014 RPC directo, m\xe1s privado"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"pagos-lightning",children:"Pagos Lightning"}),"\n",(0,r.jsx)(n.p,{children:"Lightning permite pagos instant\xe1neos y de baja comisi\xf3n \u2014 ideal para punto de venta y transacciones peque\xf1as."}),"\n",(0,r.jsx)(n.h3,{id:"facturas-bolt-11",children:"Facturas BOLT-11"}),"\n",(0,r.jsx)(n.p,{children:"Los pagos Lightning usan facturas BOLT-11:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'lnbc10u1pj...  \u2190 encoded invoice\n\nDecoded:\n  Amount: 10,000 sats\n  Description: "Coffee"\n  Payment hash: abc123...\n  Expiry: 3600 seconds\n  Node pubkey: 02def...\n'})}),"\n",(0,r.jsx)(n.h3,{id:"flujo-de-pago-lightning",children:"Flujo de Pago (Lightning)"}),"\n",(0,r.jsx)(n.mermaid,{value:"graph LR\n    A[Crear Factura] --\x3e B[Mostrar C\xf3digo QR]\n    B --\x3e C[Cliente Paga]\n    C --\x3e D[Pago se Liquida ~1s]\n    D --\x3e E[Webhook/Callback]"}),"\n",(0,r.jsx)(n.h3,{id:"opciones-de-integraci\xf3n-lightning",children:"Opciones de Integraci\xf3n Lightning"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Enfoque"}),(0,r.jsx)(n.th,{children:"Complejidad"}),(0,r.jsx)(n.th,{children:"Control"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"BTCPay Server"})}),(0,r.jsx)(n.td,{children:"Baja"}),(0,r.jsx)(n.td,{children:"Auto-hospedado, control total"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"LND/CLN API"})}),(0,r.jsx)(n.td,{children:"Media"}),(0,r.jsx)(n.td,{children:"Acceso directo al nodo"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"LDK"})}),(0,r.jsx)(n.td,{children:"Alta"}),(0,r.jsx)(n.td,{children:"Implementaci\xf3n personalizada"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.strong,{children:"API Hospedada"})," (Strike, etc.)"]}),(0,r.jsx)(n.td,{children:"Baja"}),(0,r.jsx)(n.td,{children:"Dependencia de terceros"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"btcpay-server",children:"BTCPay Server"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://btcpayserver.org/",children:"BTCPay Server"})," es el procesador de pagos open-source m\xe1s popular:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Auto-hospedado (sin terceros)"}),"\n",(0,r.jsx)(n.li,{children:"Soporte on-chain + Lightning"}),"\n",(0,r.jsx)(n.li,{children:"Integraciones con Shopify, WooCommerce y otros"}),"\n",(0,r.jsx)(n.li,{children:"Facturaci\xf3n, punto de venta y crowdfunding integrados"}),"\n",(0,r.jsx)(n.li,{children:"API para integraciones personalizadas"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Deploy with Docker\ngit clone https://github.com/btcpayserver/btcpayserver-docker\ncd btcpayserver-docker\n./btcpay-setup.sh\n"})}),"\n",(0,r.jsx)(n.h2,{id:"c\xf3digos-qr-unificados-bip-21",children:"C\xf3digos QR Unificados (BIP-21)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://github.com/bitcoin/bips/blob/master/bip-0021.mediawiki",children:"BIP-21"})," define un esquema URI que puede incluir opciones tanto on-chain como Lightning:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"bitcoin:bc1qaddress?amount=0.001&lightning=lnbc1000...\n"})}),"\n",(0,r.jsx)(n.p,{children:"Esto permite al pagador elegir on-chain o Lightning desde un \xfanico c\xf3digo QR."}),"\n",(0,r.jsx)(n.h2,{id:"lectura-recomendada",children:"Lectura Recomendada"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.btcpayserver.org/",children:"BTCPay Server Documentation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/bitcoin/bips/blob/master/bip-0021.mediawiki",children:"BIP-21: URI Scheme"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/lightning/bolts/blob/master/11-payment-encoding.md",children:"BOLT-11: Invoice Protocol"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://bitcoin.design/guide/how-it-works/payments/",children:"Bitcoin Design Guide: Payments"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453(e,n,i){i.d(n,{R:()=>a,x:()=>c});var s=i(6540);const r={},o=s.createContext(r);function a(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);